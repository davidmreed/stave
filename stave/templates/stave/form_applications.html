{% extends "base.html" %}
{% load stave_tags %}

{% block breadcrumbs %}
{% include "stave/partials/staffing_header.html" with form=form request=request only %}
{% endblock %}

{% block content %}
{% with request.user|can_manage_event:form.event as can_manage_event %}
<form method="POST" action="{{ request.path }}">
{% csrf_token %}
<input type="hidden" name="redirect_url" id="redirect_url" value="{{ request.path }}">

<details>
    <summary>How to use this page</summary>
{% if form.application_kind == form.ApplicationKind.CONFIRM_THEN_ASSIGN %}
<p>This application form is using the Confirm, then Assign model.

<ol>
    <li>Mark applications for Invitation or Rejection here as you make decisions.</li>
    <li>Draft your crews in Crew Builder. As you add users to crews, they'll automatically be marked for invitation.</li>
    <li>Send invitations and rejections from Comm Center.</li>
    <li>Users confirm or decline their invitations via email. You'll see their status here as they update.</li>
    <li>Once you finish your crews in Crew Builder, send assignments from Comm Center.</li>
</ol>
</p>
{% else %}
<p>This application form is using the Confirm Only model.

<ol>
    <li>Browse available applications here. You can choose to mark applications Rejected to hide them in Crew Builder. This won't send any emails yet.</li>
    <li>Use Crew Builder to make assignments.</li>
    <li>Once you finish your crews in Crew Builder, send assignments and rejections from Comm Center.</li>
</ol>
</p>
{% endif %}
</details>


<table>
    {% include 'stave/partials/application_table_header.html' with form=form only %}
    <tbody>
        {% for application in applications %}
        <tr>
            <td>
                {% include "stave/application_actions.html" with user=request.user can_manage_event=can_manage_event application=application ApplicationStatus=ApplicationStatus include_view=True only %}
            </td>
            {% include 'stave/partials/application_table_row.html' with form=form application=application only %}
        </tr>
        {% empty %}
        <caption>This form has not received any applications yet.</caption>
        {% endfor %}
    </tbody>
</table>
{% endwith %}
{% endblock %}
